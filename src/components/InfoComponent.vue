<template>
    <div class="info" :class="[type, {showed}]">
        <div class="info__icon">
        </div>
        <div class="info__message">
            {{ message }}
        </div>
        <div class="info__close" @click="clear">
            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                 width="23" height="23"
                 viewBox="0 0 172 172"
                 style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#ffffff"><path d="M159.745,-0.1075c-0.57781,-0.02687 -1.16906,0.02687 -1.72,0.1075c-2.31125,0.3225 -4.3,1.45125 -5.6975,3.5475l-0.1075,0.215l-0.1075,0.1075l-29.455,55.3625c-3.31906,-1.23625 -6.61125,-1.96187 -9.675,-2.0425c-3.30562,-0.08062 -6.42312,0.43 -9.245,1.6125c-5.44219,2.27094 -9.55406,6.71875 -12.255,12.3625c-0.12094,0.17469 -0.22844,0.34938 -0.3225,0.5375c-0.01344,0.02688 0.01344,0.08063 0,0.1075c-0.04031,0.06719 -0.08062,0.14781 -0.1075,0.215c-0.04031,0.13438 -0.08062,0.28219 -0.1075,0.43c-1.86781,4.66281 -4.01781,8.85531 -6.45,12.5775c-0.02687,0.04031 -0.08062,0.06719 -0.1075,0.1075c-0.30906,0.26875 -0.56437,0.60469 -0.7525,0.9675c-0.01344,0.02688 0.01344,0.08063 0,0.1075c-0.12094,0.17469 -0.22844,0.34938 -0.3225,0.5375c-8.21031,11.75781 -18.90656,18.83938 -29.025,23.22c-13.78687,5.96625 -26.9825,6.59781 -29.885,6.3425c-1.38406,-0.13437 -2.71437,0.56438 -3.37281,1.78719c-0.645,1.22281 -0.51062,2.72781 0.36281,3.80281c39.19719,48.375 96.8575,50.095 96.8575,50.095c0.68531,0.01344 1.35719,-0.17469 1.935,-0.5375c0,0 7.12188,-4.515 15.695,-15.265c6.43656,-8.07594 13.77344,-19.75312 20.1025,-35.905c0.04031,-0.04031 0.06719,-0.06719 0.1075,-0.1075c0.79281,-0.73906 1.19594,-1.81406 1.075,-2.9025c0,-0.04031 0,-0.06719 0,-0.1075c1.66625,-4.50156 3.27875,-9.23156 4.73,-14.405c0.05375,-0.215 0.09406,-0.43 0.1075,-0.645c0,-0.04031 0,-0.06719 0,-0.1075c4.58219,-11.825 -0.52406,-24.84594 -11.5025,-30.53l21.285,-59.0175v-0.1075l0.1075,-0.1075c0.69875,-2.44562 -0.1075,-4.79719 -1.3975,-6.665c-1.22281,-1.76031 -3.01,-3.14437 -5.16,-4.085v-0.1075c-0.06719,-0.02687 -0.14781,0.02688 -0.215,0c-0.04031,-0.01344 -0.06719,-0.09406 -0.1075,-0.1075c-1.67969,-0.79281 -3.52062,-1.33031 -5.2675,-1.3975zM159.315,7.095c0.77938,-0.12094 1.80063,-0.12094 2.9025,0.43l0.1075,0.1075h0.1075c1.11531,0.44344 2.0425,1.19594 2.4725,1.8275c0.43,0.63156 0.30906,1.00781 0.3225,0.9675l-20.9625,58.1575c-2.52625,-1.14219 -4.27312,-1.94844 -7.8475,-3.5475c-2.66062,-1.19594 -5.18687,-2.35156 -7.4175,-3.3325l29.025,-54.2875c-0.02687,0.02688 0.51063,-0.20156 1.29,-0.3225zM13.76,27.52c-7.56531,0 -13.76,6.19469 -13.76,13.76c0,7.56531 6.19469,13.76 13.76,13.76c7.56531,0 13.76,-6.19469 13.76,-13.76c0,-7.56531 -6.19469,-13.76 -13.76,-13.76zM13.76,34.4c3.84313,0 6.88,3.03688 6.88,6.88c0,3.84313 -3.03687,6.88 -6.88,6.88c-3.84312,0 -6.88,-3.03687 -6.88,-6.88c0,-3.84312 3.03688,-6.88 6.88,-6.88zM44.72,37.84c-3.80281,0 -6.88,3.07719 -6.88,6.88c0,3.80281 3.07719,6.88 6.88,6.88c3.80281,0 6.88,-3.07719 6.88,-6.88c0,-3.80281 -3.07719,-6.88 -6.88,-6.88zM39.56,61.92c-10.41406,0 -18.92,8.50594 -18.92,18.92c0,10.41406 8.50594,18.92 18.92,18.92c10.41406,0 18.92,-8.50594 18.92,-18.92c0,-10.41406 -8.50594,-18.92 -18.92,-18.92zM112.875,64.07c2.39188,0.06719 5.01219,0.55094 7.955,1.72c0.06719,0.04031 0.14781,0.08063 0.215,0.1075c0.77938,1.22281 2.24406,1.8275 3.655,1.505c0.38969,0.16125 0.34938,0.14781 0.7525,0.3225c2.32469,1.00781 5.25406,2.24406 8.17,3.5475c4.27313,1.90813 6.97406,3.07719 9.46,4.1925c0.06719,0.08063 0.13438,0.14781 0.215,0.215c0.73906,1.02125 1.97531,1.55875 3.225,1.3975c0.04031,0 0.06719,0 0.1075,0c8.22375,3.7625 11.85188,12.72531 9.03,21.3925c-1.35719,-0.04031 -2.39187,0.02688 -4.945,-0.5375c-1.90812,-0.41656 -3.7625,-1.08844 -5.16,-1.935c-1.3975,-0.84656 -2.20375,-1.67969 -2.58,-2.795c-0.29562,-0.9675 -1.00781,-1.74687 -1.94844,-2.13656c-0.92719,-0.40312 -1.98875,-0.36281 -2.88906,0.09406c-1.15562,0.57781 -4.07156,0.36281 -6.665,-0.9675c-1.29,-0.65844 -2.44562,-1.58562 -3.225,-2.365c-0.77937,-0.77937 -0.99437,-1.51844 -0.9675,-1.3975c-0.18812,-1.00781 -0.80625,-1.88125 -1.70656,-2.37844c-0.88687,-0.49719 -1.96187,-0.56438 -2.91594,-0.20156c-0.09406,0.04031 -1.23625,0.14781 -2.58,-0.1075c-1.34375,-0.25531 -2.9025,-0.80625 -4.4075,-1.505c-1.505,-0.69875 -2.88906,-1.54531 -3.7625,-2.2575c-0.87344,-0.71219 -0.95406,-1.45125 -0.86,-0.5375c-0.22844,-1.81406 -1.8275,-3.14437 -3.655,-3.01c-3.45344,0.3225 -6.69187,-2.21719 -8.6,-3.87c2.01563,-3.39969 4.515,-6.11406 7.6325,-7.4175c1.90813,-0.79281 4.05813,-1.14219 6.45,-1.075zM39.56,68.8c6.69188,0 12.04,5.34813 12.04,12.04c0,6.69188 -5.34812,12.04 -12.04,12.04c-6.69187,0 -12.04,-5.34812 -12.04,-12.04c0,-6.69187 5.34813,-12.04 12.04,-12.04zM95.675,79.0125c2.39188,1.72 5.71094,3.50719 9.675,3.87c0.63156,0.92719 1.31688,1.67969 2.15,2.365c1.49156,1.23625 3.3325,2.32469 5.2675,3.225c1.935,0.90031 3.96406,1.65281 6.02,2.0425c1.06156,0.20156 2.15,-0.20156 3.225,-0.215c0.51063,0.77938 0.73906,1.81406 1.3975,2.4725c1.3975,1.3975 3.06375,2.58 4.945,3.5475c2.795,1.43781 6.15438,1.935 9.46,1.505c1.12875,1.69313 2.48594,3.1175 4.085,4.085c2.35156,1.41094 4.91813,2.27094 7.31,2.795c1.67969,0.36281 3.21156,0.52406 4.6225,0.645c-0.95406,3.09063 -1.98875,5.99313 -3.01,8.815c-1.23625,-0.04031 -2.75469,-0.1075 -4.4075,-0.43c-3.7625,-0.72562 -7.32344,-2.39187 -8.815,-5.2675c-0.80625,-1.505 -2.59344,-2.19031 -4.1925,-1.6125c-1.70656,0.60469 -4.79719,0.34938 -7.4175,-0.86c-2.62031,-1.20937 -4.60906,-3.30562 -5.0525,-4.8375c-0.28219,-0.92719 -0.95406,-1.69312 -1.84094,-2.09625c-0.87344,-0.41656 -1.88125,-0.43 -2.78156,-0.05375c-0.83312,0.34938 -4.085,0.25531 -6.7725,-0.9675c-2.6875,-1.22281 -4.42094,-3.27875 -4.6225,-4.4075c-0.17469,-0.95406 -0.73906,-1.77375 -1.55875,-2.28437c-0.81969,-0.51063 -1.81406,-0.65844 -2.74125,-0.40313c-3.25187,0.87344 -5.79156,-0.28219 -7.8475,-1.8275c-0.71219,-0.52406 -1.23625,-1.10187 -1.72,-1.6125c1.66625,-2.64719 3.21156,-5.45562 4.6225,-8.4925zM87.075,93.2025c0.51063,0.47031 0.99438,0.92719 1.6125,1.3975c2.53969,1.90813 6.45,3.26531 10.8575,3.01c1.59906,2.99656 4.1925,5.29438 7.2025,6.665c2.96969,1.35719 6.14094,1.78719 9.245,1.3975c1.72,2.80844 4.11188,5.18688 7.095,6.5575c3.18469,1.46469 6.75906,1.84094 10.2125,1.29c3.21156,4.01781 7.78031,6.20813 11.825,6.9875c1.075,0.20156 2.13656,0.33594 3.1175,0.43c-5.72437,13.82719 -12.13406,23.94563 -17.7375,30.96c-7.17562,8.98969 -12.02656,12.38938 -13.115,13.115c-1.22281,-0.05375 -10.18562,-0.68531 -22.79,-4.1925c1.03469,-0.67187 2.15,-1.37062 3.3325,-2.2575c5.73781,-4.3 13.24938,-11.31437 20.5325,-22.145c0.76594,-1.11531 0.81969,-2.56656 0.12094,-3.72219c-0.69875,-1.16906 -2.00219,-1.81406 -3.34594,-1.65281c-1.00781,0.1075 -1.90812,0.65844 -2.4725,1.505c-6.82625,10.15875 -13.85406,16.6625 -19.0275,20.5325c-4.91812,3.68188 -7.76687,4.82406 -8.0625,4.945c-7.74,-2.72781 -16.31312,-6.46344 -25.0475,-11.7175c1.26313,-0.41656 2.60688,-0.9675 4.085,-1.6125c6.53063,-2.84875 15.265,-8.17 24.1875,-18.1675c1.075,-1.075 1.31688,-2.72781 0.60469,-4.05812c-0.72562,-1.34375 -2.23062,-2.05594 -3.72219,-1.74688c-0.79281,0.13438 -1.51844,0.56438 -2.0425,1.1825c-8.2775,9.25844 -16.03094,13.96156 -21.715,16.4475c-5.68406,2.48594 -8.9225,2.6875 -8.9225,2.6875c-0.14781,0.02688 -0.29562,0.06719 -0.43,0.1075c-7.13531,-5.02562 -14.25719,-11.13969 -20.9625,-18.49c6.54406,-0.51062 14.96938,-1.84094 25.37,-6.3425c10.26625,-4.44781 21.21781,-11.70406 29.9925,-23.1125z"></path></g></g></svg>
        </div>
    </div>
</template>

<script>
    import {mapGetters, mapMutations, mapState} from "vuex";

    export default {
        name: "InfoComponent",
        data() {
            return {
                showed: false,
                type: false,
                message: 'File has been updated',
                duration: 5000,
            }
        },
        computed: {
            ...mapState(['info', 'infoUpdated'])
        },
        watch: {
            infoUpdated() {
                if (this.showed) {
                    this.showed = false;
                }
                this.showNextMessage();
            }
        },
        methods: {
            ...mapMutations(['setInfoMessage', 'removeFirstInfo', 'clearInfo']),
            ...mapGetters(['getFirstInfo']),
            setInfoData(type = false, message = false, duration = false) {
                this.type = type;
                this.message = message;
                this.duration = duration;
            },
            clear() {
                this.showed = false;
                setTimeout(() => {
                    this.setInfoData();
                }, 350);
                this.clearInfo();
            },
            showNextMessage() {
                if (this.getFirstInfo) {
                    setTimeout(() => {
                        const infoIndex = this.infoUpdated;

                        this.setInfoData(
                            this.getFirstInfo().type || false,
                            this.getFirstInfo().message || false,
                            this.getFirstInfo().duration || false
                        );
                        this.removeFirstInfo();
                        this.showed = true;
                        setTimeout(() => {
                            if (infoIndex === this.infoUpdated) {
                                this.showed = false;
                                setTimeout(() => {
                                    this.setInfoData();
                                }, 350);
                            }

                            if (this.info.length) {
                                this.showNextMessage();
                            }
                        }, parseInt(this.duration));
                    }, 350);
                }
            }
        }
    }
</script>

<style lang="scss" scoped>
    .info {
        box-sizing: border-box;
        position: absolute;
        bottom: -50px;
        left: 260px;
        right: 0;
        height: 50px;
        display: flex;
        justify-content: center;
        align-items: center;
        padding-left: 2rem;
        border-top-left-radius: .267rem;
        border-top-right-radius: .267rem;
        background: rgba(185, 185, 185, 0.5);
        transition: bottom .3s ease-in-out;

        .info__icon {
            width: 23px;
            height: 23px;
            margin-left: auto;
            margin-right: 1rem;
            background-size: contain;
        }

        .info__message {
            color: #fff;
            font-size: .86rem;
        }

        .info__close {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 23px;
            height: 23px;
            margin-left: auto;
            margin-right: 1rem;
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all .15s ease-in-out;

            &:hover {
                transform: scale(1.05);
            }

            svg {
                width: 100%;
                height: 100%;
            }
        }

        &.showed {
             bottom: 0;
        }

        &.success {
            background: rgba(72,180,127,.8);

            .info__icon {
                background-image: url('../assets/info-statuses/ok.png');
            }
        }

        &.warning {
            background: rgba(191,154,42,.8);

            .info__icon {
                background-image: url('../assets/info-statuses/warning.png');
            }
        }

        &.error {
            background: rgba(217, 34, 34, 0.8);

            .info__icon {
                background-image: url('../assets/info-statuses/error.png');
            }
        }
    }
</style>